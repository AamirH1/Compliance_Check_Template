rules:
  - id: gdpr_personal_email
    framework: gdpr
    control_id: Article 5
    severity: medium
    pattern: '\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b'
    file_globs: ['*.py', '*.js', '*.java', '*.cs', '*.php', '*.rb']
    why_it_matters: 'Email addresses are personal data under GDPR requiring lawful basis for processing and appropriate safeguards'
    remediation_steps: 'Implement data minimization, ensure lawful basis for processing, provide privacy notices to data subjects'
    mapping_confidence: high

  - id: gdpr_national_id
    framework: gdpr
    control_id: Article 9
    severity: high
    pattern: '\\b\\d{3}-\\d{2}-\\d{4}\\b|\\b\\d{9}\\b'
    file_globs: ['*']
    why_it_matters: 'National identification numbers may be considered special category personal data requiring explicit consent'
    remediation_steps: 'Ensure explicit consent or legal basis for processing, implement additional security measures'
    mapping_confidence: medium
    needs_review: true

  - id: gdpr_date_of_birth
    framework: gdpr
    control_id: Article 5
    severity: medium
    pattern: |
      \\b(?:dob|date[_-]?of[_-]?birth|birth[_-]?date)\\s*[:=]\\s*["']?\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4}["']?
    file_globs: ['*']
    why_it_matters: 'Date of birth is personal data that must be processed with appropriate lawful basis and security measures'
    remediation_steps: 'Ensure lawful basis for processing birth dates, implement data minimization principles'

  - id: gdpr_ip_address
    framework: gdpr
    control_id: Article 4
    severity: low
    pattern: '\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b'
    file_globs: ['*.log', '*.py', '*.js', '*.java']
    why_it_matters: 'IP addresses can be personal data under GDPR when they identify individuals'
    remediation_steps: 'Implement IP address anonymization, ensure lawful basis for IP processing, consider data retention limits'
    mapping_confidence: medium

  - id: gdpr_cookie_tracking
    framework: gdpr
    control_id: Article 6
    severity: medium
    pattern: 'document\\.cookie|localStorage\\.setItem|sessionStorage\\.setItem'
    file_globs: ['*.js', '*.html']
    why_it_matters: 'Cookie and local storage usage may process personal data requiring consent under GDPR'
    remediation_steps: 'Implement cookie consent mechanisms, provide clear privacy notices, allow users to withdraw consent'
